/*
 This file is part of the Computer Breaker project.

    Computer Breaker is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    Computer Breaker is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Computer Breaker; if not, write to the Free Software
    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/

#include "../util/Logger.hh"
#include "Exploit.hh"

Exploit::Exploit() {
	_date_publication = -1;
	_author = "";
	_description = "";
	_attacks = new TCollection<Attack *>();
}

Exploit::Exploit(std::string date_publication, std::string author, std::string description,
	TCollection<Attack*> *attacks) {
	_date_publication = date_publication;
	_author = author;
	_description = description;
	_attacks = attacks;
}

Exploit::Exploit(const Exploit&) {
}

Exploit::~Exploit() {
	delete _attacks;
}

std::string Exploit::getDatePublication() {
	return _date_publication;
}

std::string Exploit::getAuthor() {
	return _author;
}

std::string Exploit::getDescription() {
	return _description;
}

TCollection<Attack*> *Exploit::getAttacks() {
	return _attacks;
}

void Exploit::setDatePublication(std::string date_publication) {
	_date_publication = date_publication;
}

void Exploit::setAuthor(std::string author) {
	_author = author;
}

void Exploit::setDescription(std::string description) {
	_description = description;
}

void Exploit::setAttacks(TCollection<Attack*> *attacks) {
	_attacks = attacks;
}

std::string Exploit::toString() {
	std::string result = "Exploit(";
	result.append("author=\"");
	result.append(_author);
	result.append("\", ");
	result.append("date=\"");
	result.append(_date_publication);
	result.append("\", ");
	result.append("description=\"");
	result.append(_description.substr(0,20));
	result.append("\", ");
	result.append("#attacks=\"");
	result.append(_attacks->toString());
	result.append("\")");
	return result;
}
